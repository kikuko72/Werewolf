@startuml
title クラス構成概観

class "Game" as Game {
    playersState : PlayersState
    gameState : GameState
}
class "Player" as Player {
    userID : ID
    isAlive : boolean
    role : Role
}
class "SkillApplier" as SkillApplier {
    plan : ApplyPlan
    + SkillApplier(skills : Map<SkillKey, Skill>)
    +apply(List<SkillPlan>, playersState : PlayersState) : PlayersState
    -resolvePlan() : ApplyPlan
}
class "ApplyPlan" as ApplyPlan {
    plan : List<List<Skill>>
    ~execute(skillPlans : List<SkillPlan> , playersState : PlayersState) : List<PlayersStatePatch>
}
class "PlayersState" as PlayersState {
    applyPath(patch PlayersStatePatch) : PlayersState
}
class "PlayersStatePatch" as PlayersStatePatch {
    ~mergePatches(patches : List<PlayersStatePatch>) : PlayersStatePatch
}
class "SkillPlan" as SkillPlan {
    skillKey : SkillKey
    victim : Player
    ~getSkillKey() : SkillKey
    ~getVictim() : Player
}

Game "1" *- "1" PlayersState
Game "1" *---- "1" SkillApplier
PlayersState  - PlayersStatePatch
PlayersState "1" o-down- "3..*" Player
SkillApplier "1" *-  "1" ApplyPlan
ApplyPlan - SkillPlan
ApplyPlan -up- PlayersStatePatch

@enduml